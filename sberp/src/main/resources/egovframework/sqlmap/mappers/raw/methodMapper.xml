<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="egovframework.raw.service.MethodMapper">

	<insert id="insertCe" parameterType="ceDTO">
		<selectKey resultType="int" keyProperty="ceSeq" order="BEFORE">
	        SELECT IFNULL(MAX(CE_SEQ)+1,1) ceSeq FROM METHOD_CE_TB
	    </selectKey>
		INSERT INTO METHOD_CE_TB
		(
			CE_SEQ,
			RAW_SEQ,
			VLT_AC_YN,
			VLT_ETC,
			VLT_ETC_YN,
			VAR_N_YN,
			VAR_Y_YN,
			ROOM1_YN,
			ROOM2_YN,
			ROOM3_YN,
			ROOM_ETC_YN,
			ROOM_ETC,
			TEMP,
			TEMP_PLUS,
			HMDT,
			HMDT_PLUS,
			MSRMN_YEAR,
			MSRMN_MON,
			MSRMN_DAY,
			MSRMN_HOUR,
			MSRMN_MIN,
			SIGN,
			SIGN_URL,
			RESULT_CODE,
			INS_MEM_ID,
			UDT_MEM_ID
		)
		VALUES
		(
			#{ceSeq},
			#{rawSeq},
			#{vltAcYn},
			#{vltEtc},
			#{vltEtcYn},
			#{varNYn},
			#{varYYn},
			#{room1Yn},
			#{room2Yn},
			#{room3Yn},
			#{roomEtcYn},
			#{roomEtc},
			#{temp},
			#{tempPlus},
			#{hmdt},
			#{hmdtPlus},
			#{msrmnYear},
			#{msrmnMon},
			#{msrmnDay},
			#{msrmnHour},
			#{msrmnMin},
			#{sign},
			#{atchFileId},
			#{resultCode},
			#{insMemId},
			#{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			VAR_N_YN = #{varNYn},
			VAR_Y_YN = #{varYYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM3_YN = #{room3Yn},
			ROOM_ETC_YN = #{roomEtcYn},
			ROOM_ETC = #{roomEtc},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>

	<insert id="insertMac">
		<foreach collection="macList" item="item" separator=";">
		INSERT INTO RAW_MAC_TB
		(
			MACHINE_TYPE,
			RAW_SEQ,
			MACHINE_SEQ,
			REFORM_DT,
			USE_YN
		)
		VALUES
		(
			#{machineType},
			#{rawSeq},
			#{item.machineSeq},
			(SELECT REFORM_DT FROM MACHINE_TB WHERE MACHINE_SEQ = #{item.machineSeq} LIMIT 1),
			#{item.useYn}
		)
		ON DUPLICATE KEY UPDATE
			USE_YN = #{item.useYn}
		</foreach>
	</insert>
	
	<insert id="insertTwoMac">
		<foreach collection="macList" item="item" separator=";">
		INSERT INTO RAW_MAC_TB
		(
			MACHINE_TYPE,
			RAW_SEQ,
			MACHINE_SEQ,
			REFORM_DT,
			USE_YN
		)
		VALUES
		(
			#{item.machineType},
			#{rawSeq},
			#{item.machineSeq},
			(SELECT REFORM_DT FROM MACHINE_TB WHERE MACHINE_SEQ = #{item.machineSeq} LIMIT 1),
			#{item.useYn}
		)
		ON DUPLICATE KEY UPDATE
			USE_YN = #{item.useYn}
		</foreach>
	</insert>
	
	<update id="updateTwoMac">
		<foreach collection="macList" item="item" separator=";">
		UPDATE RAW_MAC_TB
		SET
			USE_YN = #{item.useYn}
		WHERE RAW_MAC_SEQ = #{item.rawMacSeq}
		AND RAW_SEQ = #{rawSeq}
		</foreach>
	</update>
	
	<select id="macList" resultType="egovMap">
		SELECT
		    RAW_MAC_SEQ,
		    #{machineType} MACHINE_TYPE,
		    RAW_SEQ,
		    RAW_MAC_TB.MACHINE_SEQ,
		    NAME,
		    MODEL,
		    MNFCT_CMPNY,
		    MNFCT_SERIAL,
		    IFNULL (DATE_FORMAT(RAW_MAC_TB.REFORM_DT, '%Y-%m-%d'), '-') reformDtStr,
		    IFNULL (FN_CODE_NAME(REFORM_PERIOD, 'MY'), '-') REFORM_PERIOD,
		    USE_YN
		FROM
		    RAW_MAC_TB
		    INNER JOIN MACHINE_TB on RAW_MAC_TB.MACHINE_SEQ = MACHINE_TB.MACHINE_SEQ
		WHERE
		    1 = 1
		AND RAW_SEQ = #{rawSeq}
		<!-- CA, CB가 한페이지에 나와야 하므로 머신타입 유지 -->
		<if test="machineType == 'CA' or machineType == 'CB'">
			AND MACHINE_TYPE = 'CE'
			<if test="machineType == 'CA'">and CEA_YN = 1</if>
			<if test="machineType == 'CB'">and CEB_YN = 1</if>
		</if>
		<if test="machineType == 'RA' or machineType == 'RB'">
			AND (MACHINE_TYPE = 'RE' OR MACHINE_TYPE = #{machineType})
			<if test="machineType == 'RA'">and REA_YN = 1</if>
			<if test="machineType == 'RB'">and REB_YN = 1</if>
		</if>
		<if test="machineType != 'CA' and machineType != 'CB' and machineType != 'RA' and machineType != 'RB'">
			AND MACHINE_TYPE = #{machineType}
		</if>
		ORDER BY 
		<choose>
			<when test="machineType == 'ED'">MACHINE_TB.ESD_ORDR ASC,</when>
			<when test="machineType == 'RS'">MACHINE_TB.RS_ORDR ASC,</when>
			<when test="machineType == 'ET'">MACHINE_TB.EFT_ORDR ASC,</when>
			<when test="machineType == 'SG'">MACHINE_TB.SURGE_ORDR ASC,</when>
			<when test="machineType == 'CS'">MACHINE_TB.CS_ORDR ASC,</when>
			<when test="machineType == 'MF'">MACHINE_TB.MFLD_ORDR ASC,</when>
			<when test="machineType == 'VD'">MACHINE_TB.VDIP_ORDR ASC,</when>
			<when test="machineType == 'CA'">MACHINE_TB.CEA_ORDR ASC,</when>
			<when test="machineType == 'CB'">MACHINE_TB.CEB_ORDR ASC,</when>
			<when test="machineType == 'RA' or machineType == 'RE1' or machineType == 'RE2'">MACHINE_TB.REA_ORDR ASC,</when>
			<when test="machineType == 'RB' or machineType == 'RE3' ">MACHINE_TB.REB_ORDR ASC,</when>
		</choose>
		MACHINE_TB.MACHINE_SEQ DESC
	</select>

	<select id="emptyMacList" resultType="egovMap">
		SELECT
		    '' RAW_MAC_SEQ,
		    #{machineType} MACHINE_TYPE,
		    '' RAW_SEQ,
		    MACHINE_TB.MACHINE_SEQ,
		    NAME,
		    model,
		    MNFCT_CMPNY,
		    MNFCT_SERIAL,
		    IFNULL (DATE_FORMAT(REFORM_DT, '%Y-%m-%d'), '-') reformDtStr,
		    IFNULL (FN_CODE_NAME(REFORM_PERIOD, 'MY'), '0년') REFORM_PERIOD,
		    false USE_YN
		FROM
		    MACHINE_TB
		WHERE
		    1 = 1
		<choose>
			<when test="machineType == 'ED'">AND ESD_YN = 1</when>
			<when test="machineType == 'RS'">AND RS_YN = 1</when>
			<when test="machineType == 'ET'">AND EFT_YN = 1</when>
			<when test="machineType == 'SG'">AND SURGE_YN = 1</when>
			<when test="machineType == 'CS'">AND CS_YN = 1</when>
			<when test="machineType == 'MF'">AND MFLD_YN = 1</when>
			<when test="machineType == 'VD'">AND VDIP_YN = 1</when>
			<when test="machineType == 'CA'">AND CEA_YN = 1</when>
			<when test="machineType == 'CB'">AND CEB_YN = 1</when>
			<when test="machineType == 'RA'">AND REA_YN = 1</when>
			<when test="machineType == 'RB'">AND REB_YN = 1</when>
			<when test="machineType == 'DP'">AND DP_YN = 1</when>
			<when test="machineType == 'CK'">AND CLK_YN = 1</when>
		</choose>
		ORDER BY 
		<choose>
			<when test="machineType == 'ED'">MACHINE_TB.ESD_ORDR ASC,</when>
			<when test="machineType == 'RS'">MACHINE_TB.RS_ORDR ASC,</when>
			<when test="machineType == 'ET'">MACHINE_TB.EFT_ORDR ASC,</when>
			<when test="machineType == 'SG'">MACHINE_TB.SURGE_ORDR ASC,</when>
			<when test="machineType == 'CS'">MACHINE_TB.CS_ORDR ASC,</when>
			<when test="machineType == 'MF'">MACHINE_TB.MFLD_ORDR ASC,</when>
			<when test="machineType == 'VD'">MACHINE_TB.VDIP_ORDR ASC,</when>
			<when test="machineType == 'CA'">MACHINE_TB.CEA_ORDR ASC,</when>
			<when test="machineType == 'CB'">MACHINE_TB.CEB_ORDR ASC,</when>
			<when test="machineType == 'RA'">MACHINE_TB.REA_ORDR ASC,</when>
			<when test="machineType == 'RB'">MACHINE_TB.REB_ORDR ASC,</when>
			<when test="machineType == 'DP'">MACHINE_TB.DP_ORDR ASC,</when>
			<when test="machineType == 'CK'">MACHINE_TB.CLK_ORDR ASC,</when>
		</choose>
		MACHINE_TB.MACHINE_SEQ DESC
	</select>
		
	<select id="esdSubList" parameterType="int" resultType="egovMap">
		SELECT 
			ESD_SUB_SEQ,
		    ESD_SEQ,
		    DRCTL,
		    DC_CODE,
		    RESULT_CODE,
		    MEMO,
		    STATE
		FROM METHOD_ESD_SUB_TB
		WHERE 1=1
		AND STATE != 'D'
		AND ESD_SEQ = #{esdSeq}
	</select>
	
	<select id="ceDetail" parameterType="int" resultType="ceDTO">
		SELECT CE_SEQ,
		    RAW_SEQ,
		    VLT_AC_YN,
		    VLT_ETC,
		    VLT_ETC_YN,
		    VAR_N_YN,
		    VAR_Y_YN,
		    ROOM1_YN,
		    ROOM2_YN,
		    ROOM3_YN,
		    ROOM_ETC_YN,
			ROOM_ETC,
		    TEMP,
		    TEMP_PLUS,
		    HMDT,
		    HMDT_PLUS,
		    MSRMN_YEAR,
		    MSRMN_MON,
		    MSRMN_DAY,
		    MSRMN_HOUR,
		    MSRMN_MIN,
		    SIGN,
		    FN_GET_IMAGE(SIGN_URL,0) SIGN_URL,
		    SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE
		FROM METHOD_CE_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>

	<select id="reDetail" parameterType="int" resultType="reDTO">
		SELECT RE_SEQ,
		    METHOD_RE_TB.RAW_SEQ,
		    TEST_ITEM_TB.TEST_STNDR_SEQ,
		    VLT_AC_YN,
		    VLT_ETC,
		    VLT_ETC_YN,
		    VAR_N_YN,
		    VAR_Y_YN,
		    HZ1_CODE,
		    HZ1_VLT10M_YN,
		    HZ1_VLT3M_YN,
		    HZ1_VLT_ETC1,
		    HZ1_VLT_ETC1_YN,
		    HZ1_VLT_ETC2,
		    HZ1_VLT_ETC2_YN,
		    HZ1_LNGTH_1M_YN,
		    HZ1_LNGTH_3M_YN,
		    HZ1_LNGTH_10M_YN,
		    HZ1_LNGTH_30M_YN,
		    HZ1_ANTN_2M_YN,
		    HZ1_ANTN_3M_YN,
		    HZ1_ANTN_4M_YN,
		    HZ1_TEMP,
		    HZ1_TEMP_PLUS,
		    HZ1_HMDT,
		    HZ1_HMDT_PLUS,
		    HZ1_MSRMN_YEAR,
		    HZ1_MSRMN_MON,
		    HZ1_MSRMN_DAY,
		    HZ1_MSRMN_HOUR,
		    HZ1_MSRMN_MIN,
		    HZ1_SIGN,
		    FN_GET_IMAGE(HZ1_SIGN_URL,0) HZ1_SIGN_URL,
		    HZ1_SIGN_URL hz1AtchFileId,
		    HZ1_RESULT_CODE,
		    HZ2_CODE,
		    HZ2_VLT10M_YN,
		    HZ2_VLT3M_YN,
		    HZ2_VLT_ETC1,
		    HZ2_VLT_ETC1_YN,
		    HZ2_VLT_ETC2,
		    HZ2_VLT_ETC2_YN,
		    HZ2_LNGTH_1M_YN,
		    HZ2_LNGTH_3M_YN,
		    HZ2_LNGTH_10M_YN,
		    HZ2_LNGTH_30M_YN,
		    HZ2_TEMP,
		    HZ2_TEMP_PLUS,
		    HZ2_HMDT,
		    HZ2_HMDT_PLUS,
		    HZ2_MSRMN_YEAR,
		    HZ2_MSRMN_MON,
		    HZ2_MSRMN_DAY,
		    HZ2_MSRMN_HOUR,
		    HZ2_MSRMN_MIN,
		    HZ2_SIGN,
		    FN_GET_IMAGE(HZ2_SIGN_URL,0) HZ2_SIGN_URL,
		    HZ2_SIGN_URL hz2AtchFileId,
		    HZ2_RESULT_CODE,
		    
			HZ3_VLT10M_YN,
			HZ3_VLT_ETC1_YN,
			HZ3_LNGTH_3M_YN,
			HZ3_TEMP,
			HZ3_TEMP_PLUS,
			HZ3_HMDT,
			HZ3_HMDT_PLUS,
			HZ3_MSRMN_YEAR,
			HZ3_MSRMN_MON,
			HZ3_MSRMN_DAY,
			HZ3_MSRMN_HOUR,
			HZ3_MSRMN_MIN,
			HZ3_SIGN,
			FN_GET_IMAGE(HZ3_SIGN_URL,0) HZ3_SIGN_URL,
			HZ3_SIGN_URL hz3AtchFileId,
			HZ3_RESULT_CODE
			
		FROM METHOD_RE_TB
			
			INNER JOIN RAW_TB
            ON METHOD_RE_TB.RAW_SEQ = RAW_TB.RAW_SEQ
            INNER jOIN TEST_TB
            ON RAW_TB.TEST_SEQ = TEST_TB.TEST_SEQ
            INNER jOIN TEST_ITEM_TB
            ON TEST_ITEM_TB.TEST_ITEM_SEQ = TEST_TB.TEST_ITEM_SEQ
            
		WHERE 1=1
		AND METHOD_RE_TB.RAW_SEQ = #{rawSeq}
	</select>
	
	<insert id="insertRe" parameterType="reDTO">
		<selectKey resultType="int" keyProperty="reSeq" order="BEFORE">
	        SELECT ifnull(MAX(RE_SEQ)+1,1) reSeq FROM METHOD_RE_TB
	    </selectKey>
		INSERT INTO METHOD_RE_TB
		(
			RE_SEQ,
			RAW_SEQ,
			VLT_AC_YN,
			VLT_ETC,
			VLT_ETC_YN,
			VAR_N_YN,
			VAR_Y_YN,
			HZ1_CODE,
			HZ1_VLT10M_YN,
			HZ1_VLT3M_YN,
			HZ1_VLT_ETC1,
			HZ1_VLT_ETC1_YN,
			HZ1_VLT_ETC2,
			HZ1_VLT_ETC2_YN,
			HZ1_LNGTH_1M_YN,
			HZ1_LNGTH_3M_YN,
			HZ1_LNGTH_10M_YN,
			HZ1_LNGTH_30M_YN,
			HZ1_ANTN_2M_YN,
			HZ1_ANTN_3M_YN,
			HZ1_ANTN_4M_YN,
			HZ1_TEMP,
			HZ1_TEMP_PLUS,
			HZ1_HMDT,
			HZ1_HMDT_PLUS,
			HZ1_MSRMN_YEAR,
			HZ1_MSRMN_MON,
			HZ1_MSRMN_DAY,
			HZ1_MSRMN_HOUR,
			HZ1_MSRMN_MIN,
			HZ1_SIGN,
			HZ1_SIGN_URL,
			HZ1_RESULT_CODE,
			HZ2_CODE,
			HZ2_VLT10M_YN,
			HZ2_VLT3M_YN,
			HZ2_VLT_ETC1,
			HZ2_VLT_ETC1_YN,
			HZ2_VLT_ETC2,
			HZ2_VLT_ETC2_YN,
			HZ2_LNGTH_1M_YN,
			HZ2_LNGTH_3M_YN,
			HZ2_LNGTH_10M_YN,
			HZ2_LNGTH_30M_YN,
			HZ2_TEMP,
			HZ2_TEMP_PLUS,
			HZ2_HMDT,
			HZ2_HMDT_PLUS,
			HZ2_MSRMN_YEAR,
			HZ2_MSRMN_MON,
			HZ2_MSRMN_DAY,
			HZ2_MSRMN_HOUR,
			HZ2_MSRMN_MIN,
			HZ2_SIGN,
			HZ2_SIGN_URL,
			HZ2_RESULT_CODE,
			
			<if test="hz3Vlt10mYn != null and hz3Vlt10mYn != ''">HZ3_VLT10M_YN,</if>
			<if test="hz3VltEtc1Yn != null and hz3VltEtc1Yn != ''">HZ3_VLT_ETC1_YN,</if>
			<if test="hz3Lngth3mYn != null and hz3Lngth3mYn != ''">HZ3_LNGTH_3M_YN,</if>
			<if test="hz3Temp != null and hz3Temp != ''">HZ3_TEMP,</if>
			<if test="hz3TempPlus != null and hz3TempPlus != ''">HZ3_TEMP_PLUS,</if>
			<if test="hz3Hmdt != null and hz3Hmdt != ''">HZ3_HMDT,</if>
			<if test="hz3HmdtPlus != null and hz3HmdtPlus != ''">HZ3_HMDT_PLUS,</if>
			<if test="hz3MsrmnYear != null and hz3MsrmnYear != ''">HZ3_MSRMN_YEAR,</if>
			<if test="hz3MsrmnMon != null and hz3MsrmnMon != ''">HZ3_MSRMN_MON,</if>
			<if test="hz3MsrmnDay != null and hz3MsrmnDay != ''">HZ3_MSRMN_DAY,</if>
			<if test="hz3MsrmnHour != null and hz3MsrmnHour != ''">HZ3_MSRMN_HOUR,</if>
			<if test="hz3MsrmnMin != null and hz3MsrmnMin != ''">HZ3_MSRMN_MIN,</if>
			<if test="hz3Sign != null and hz3Sign != ''">HZ3_SIGN,</if>
			<if test="hz3SignUrl != null and hz3SignUrl != ''">HZ3_SIGN_URL,</if>
			<if test="hz3ResultCode != null and hz3ResultCode != ''">HZ3_RESULT_CODE,</if>
			
			INS_MEM_ID,
			UDT_MEM_ID
		)
		VALUES
		(
			#{reSeq},
			#{rawSeq},
			#{vltAcYn},
			#{vltEtc},
			#{vltEtcYn},
			#{varNYn},
			#{varYYn},
			#{hz1Code},
			#{hz1Vlt10mYn},
			#{hz1Vlt3mYn},
			#{hz1VltEtc1},
			#{hz1VltEtc1Yn},
			#{hz1VltEtc2},
			#{hz1VltEtc2Yn},
			#{hz1Lngth1mYn},
			#{hz1Lngth3mYn},
			#{hz1Lngth10mYn},
			#{hz1Lngth30mYn},
			#{hz1Antn2mYn},
			#{hz1Antn3mYn},
			#{hz1Antn4mYn},
			#{hz1Temp},
			#{hz1TempPlus},
			#{hz1Hmdt},
			#{hz1HmdtPlus},
			#{hz1MsrmnYear},
			#{hz1MsrmnMon},
			#{hz1MsrmnDay},
			#{hz1MsrmnHour},
			#{hz1MsrmnMin},
			#{hz1Sign},
			#{hz1AtchFileId},
			#{hz1ResultCode},
			#{hz2Code},
			#{hz2Vlt10mYn},
			#{hz2Vlt3mYn},
			#{hz2VltEtc1},
			#{hz2VltEtc1Yn},
			#{hz2VltEtc2},
			#{hz2VltEtc2Yn},
			#{hz2Lngth1mYn},
			#{hz2Lngth3mYn},
			#{hz2Lngth10mYn},
			#{hz2Lngth30mYn},
			#{hz2Temp},
			#{hz2TempPlus},
			#{hz2Hmdt},
			#{hz2HmdtPlus},
			#{hz2MsrmnYear},
			#{hz2MsrmnMon},
			#{hz2MsrmnDay},
			#{hz2MsrmnHour},
			#{hz2MsrmnMin},
			#{hz2Sign},
			#{hz2AtchFileId},
			#{hz2ResultCode},
			
			<if test="hz3Vlt10mYn != null and hz3Vlt10mYn != ''">#{hz3Vlt10mYn},</if>
			<if test="hz3VltEtc1Yn != null and hz3VltEtc1Yn != ''">#{hz3VltEtc1Yn},</if>
			<if test="hz3Lngth3mYn != null and hz3Lngth3mYn != ''">#{hz3Lngth3mYn},</if>
			<if test="hz3Temp != null and hz3Temp != ''">#{hz3Temp},</if>
			<if test="hz3TempPlus != null and hz3TempPlus != ''">#{hz3TempPlus},</if>
			<if test="hz3Hmdt != null and hz3Hmdt != ''">#{hz3Hmdt},</if>
			<if test="hz3HmdtPlus != null and hz3HmdtPlus != ''">#{hz3HmdtPlus},</if>
			<if test="hz3MsrmnYear != null and hz3MsrmnYear != ''">#{hz3MsrmnYear},</if>
			<if test="hz3MsrmnMon != null and hz3MsrmnMon != ''">#{hz3MsrmnMon},</if>
			<if test="hz3MsrmnDay != null and hz3MsrmnDay != ''">#{hz3MsrmnDay},</if>
			<if test="hz3MsrmnHour != null and hz3MsrmnHour != ''">#{hz3MsrmnHour},</if>
			<if test="hz3MsrmnMin != null and hz3MsrmnMin != ''">#{hz3MsrmnMin},</if>
			<if test="hz3Sign != null and hz3Sign != ''">#{hz3Sign},</if>
			<if test="hz3SignUrl != null and hz3SignUrl != ''">#{hz3SignUrl},</if>
			<if test="hz3ResultCode != null and hz3ResultCode != ''">#{hz3ResultCode},</if>
			
			#{insMemId},
			#{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			<if test="vltAcYn != null">VLT_AC_YN = #{vltAcYn},</if>
			<if test="vltEtc != null">VLT_ETC = #{vltEtc},</if>
			<if test="vltEtcYn != null">VLT_ETC_YN = #{vltEtcYn},</if>
			VAR_N_YN = #{varNYn},
			VAR_Y_YN = #{varYYn},
			HZ1_CODE = #{hz1Code},
			HZ1_VLT_ETC1 = #{hz1VltEtc1},
			HZ1_LNGTH_1M_YN = #{hz1Lngth1mYn},
			HZ1_LNGTH_10M_YN = #{hz1Lngth10mYn},
			HZ1_LNGTH_30M_YN = #{hz1Lngth30mYn},
			HZ1_ANTN_3M_YN = #{hz1Antn3mYn},
			HZ1_ANTN_4M_YN = #{hz1Antn4mYn},
			
			<if test="hz1ResultCode != null">
			HZ1_VLT10M_YN = #{hz1Vlt10mYn},
			HZ1_VLT3M_YN = #{hz1Vlt3mYn},
			HZ1_VLT_ETC1_YN = #{hz1VltEtc1Yn},
			HZ1_VLT_ETC2 = #{hz1VltEtc2},
			HZ1_VLT_ETC2_YN = #{hz1VltEtc2Yn},
			HZ1_LNGTH_3M_YN = #{hz1Lngth3mYn},
			HZ1_ANTN_2M_YN = #{hz1Antn2mYn},
			HZ1_TEMP = #{hz1Temp},
			HZ1_TEMP_PLUS = #{hz1TempPlus},
			HZ1_HMDT = #{hz1Hmdt},
			HZ1_HMDT_PLUS = #{hz1HmdtPlus},
			HZ1_MSRMN_YEAR = #{hz1MsrmnYear},
			HZ1_MSRMN_MON = #{hz1MsrmnMon},
			HZ1_MSRMN_DAY = #{hz1MsrmnDay},
			HZ1_MSRMN_HOUR = #{hz1MsrmnHour},
			HZ1_MSRMN_MIN = #{hz1MsrmnMin},
			HZ1_SIGN = #{hz1Sign},
			HZ1_SIGN_URL = #{hz1AtchFileId},
			HZ1_RESULT_CODE = #{hz1ResultCode},
			</if>
			
			HZ2_CODE = #{hz2Code},
			HZ2_VLT_ETC1 = #{hz2VltEtc1},
			HZ2_VLT_ETC1_YN = #{hz2VltEtc1Yn},
			HZ2_VLT_ETC2 = #{hz2VltEtc2},
			HZ2_VLT_ETC2_YN = #{hz2VltEtc2Yn},
			HZ2_LNGTH_1M_YN = #{hz2Lngth1mYn},
			HZ2_LNGTH_30M_YN = #{hz2Lngth30mYn},
			
			<if test="hz2ResultCode != null">
			HZ2_VLT10M_YN = #{hz2Vlt10mYn},
			HZ2_VLT3M_YN = #{hz2Vlt3mYn},
			HZ2_LNGTH_3M_YN = #{hz2Lngth3mYn},
			HZ2_LNGTH_10M_YN = #{hz2Lngth10mYn},
			HZ2_TEMP = #{hz2Temp},
			HZ2_TEMP_PLUS = #{hz2TempPlus},
			HZ2_HMDT = #{hz2Hmdt},
			HZ2_HMDT_PLUS = #{hz2HmdtPlus},
			HZ2_MSRMN_YEAR = #{hz2MsrmnYear},
			HZ2_MSRMN_MON = #{hz2MsrmnMon},
			HZ2_MSRMN_DAY = #{hz2MsrmnDay},
			HZ2_MSRMN_HOUR = #{hz2MsrmnHour},
			HZ2_MSRMN_MIN = #{hz2MsrmnMin},
			HZ2_SIGN = #{hz2Sign},
			HZ2_SIGN_URL = #{hz2AtchFileId},
			HZ2_RESULT_CODE = #{hz2ResultCode},
			</if>
			
			<if test="hz3ResultCode != null">
			HZ3_VLT10M_YN = #{hz3Vlt10mYn},
			HZ3_VLT_ETC1_YN = #{hz3VltEtc1Yn},
			HZ3_LNGTH_3M_YN = #{hz3Lngth3mYn},
			HZ3_TEMP = #{hz3Temp},
			HZ3_TEMP_PLUS = #{hz3TempPlus},
			HZ3_HMDT = #{hz3Hmdt},
			HZ3_HMDT_PLUS = #{hz3HmdtPlus},
			HZ3_MSRMN_YEAR = #{hz3MsrmnYear},
			HZ3_MSRMN_MON = #{hz3MsrmnMon},
			HZ3_MSRMN_DAY = #{hz3MsrmnDay},
			HZ3_MSRMN_HOUR = #{hz3MsrmnHour},
			HZ3_MSRMN_MIN = #{hz3MsrmnMin},
			HZ3_SIGN = #{hz3Sign},
			HZ3_SIGN_URL = #{hz3AtchFileId},
			HZ3_RESULT_CODE = #{hz3ResultCode},
			</if>
			
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<select id="esdDetail" parameterType="int" resultType="esdDTO">
		SELECT ESD_SEQ,
		    RAW_SEQ,
		    VLT_AC_YN,
		    VLT_ETC,
		    VLT_ETC_YN,
		    VAR_N_YN,
		    VAR_Y_YN,
		    ROOM1_YN,
		    ROOM2_YN,
		    ROOM_ETC_YN,
			ROOM_ETC,
		    TEMP,
		    TEMP_PLUS,
		    HMDT,
		    HMDT_PLUS,
		    BRMT,
		    BRMT_PLUS,
		    DC_1S_YN,
		    DC_ETC,
		    DC_ETC_YN,
		    DC_GIN_YN,
		    DC_CON_YN,
		    DC_IMP_YN,
		    DC_IMP_ETC,
		    DC_IMP_ETC_YN,
		    EVLTN_A_YN,
		    EVLTN_B_YN,
		    EVLTN_C_YN,
		    DC_CON_2_YN,
		    DC_CON_4_YN,
		    DC_CON_6_YN,
		    DC_CON_8_YN,
		    DC_CON_ETC,
		    DC_CON_ETC_YN,
		    DC_GIN_2_YN,
		    DC_GIN_4_YN,
		    DC_GIN_6_YN,
		    DC_GIN_8_YN,
		    DC_GIN_ETC,
		    DC_GIN_ETC_YN,
		    H_2_YN,
		    H_4_YN,
		    H_6_YN,
		    H_8_YN,
		    H_ETC,
		    H_ETC_YN,
		    V_2_YN,
		    V_4_YN,
		    V_6_YN,
		    V_8_YN,
		    V_ETC,
		    V_ETC_YN,
		    MSRMN_YEAR,
		    MSRMN_MON,
		    MSRMN_DAY,
		    MSRMN_HOUR,
		    MSRMN_MIN,
		    SIGN,
		    FN_GET_IMAGE(SIGN_URL,0) SIGN_URL,
		    SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    INDRC_H_YN,
		    INDRC_H_RESULT_CODE,
		    INDRC_H_MEMO,
		    INDRC_V_YN,
		    INDRC_V_RESULT_CODE,
		    INDRC_V_MEMO,
		    CMNT_A_YN,
		    CMNT_ETC,
		    CMNT_ETC_YN,
		    IMG_URL
		FROM METHOD_ESD_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<insert id="insertEsd" parameterType="esdDTO">
	    <selectKey resultType="int" keyProperty="esdSeq" order="AFTER">
	        SELECT ESD_SEQ esdSeq FROM METHOD_ESD_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
		INSERT INTO METHOD_ESD_TB
		(
			ESD_SEQ, RAW_SEQ,
			VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
			ROOM1_YN, ROOM2_YN, ROOM_ETC_YN, ROOM_ETC,
			TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
			DC_1S_YN, DC_ETC, DC_ETC_YN, DC_GIN_YN, DC_CON_YN, DC_IMP_YN, DC_IMP_ETC, DC_IMP_ETC_YN,
			EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
			DC_CON_2_YN, DC_CON_4_YN, DC_CON_6_YN, DC_CON_8_YN, DC_CON_ETC, DC_CON_ETC_YN,
			DC_GIN_2_YN, DC_GIN_4_YN, DC_GIN_6_YN, DC_GIN_8_YN, DC_GIN_ETC, DC_GIN_ETC_YN,
			H_2_YN, H_4_YN, H_6_YN, H_8_YN, H_ETC, H_ETC_YN,
			V_2_YN, V_4_YN, V_6_YN, V_8_YN, V_ETC, V_ETC_YN,
			MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
			SIGN, SIGN_URL, RESULT_CODE,
			INDRC_H_YN, INDRC_H_RESULT_CODE, INDRC_H_MEMO,
			INDRC_V_YN, INDRC_V_RESULT_CODE, INDRC_V_MEMO,
			CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN,IMG_URL,
			INS_MEM_ID, UDT_MEM_ID
		)
		VALUES
		(
			(SELECT ifnull(MAX(seq.ESD_SEQ)+1,1) esdSeq FROM METHOD_ESD_TB seq), #{rawSeq},
			#{vltAcYn}, #{vltEtc}, #{vltEtcYn}, #{varNYn}, #{varYYn},
			#{room1Yn}, #{room2Yn}, #{roomEtcYn}, #{roomEtc},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus}, #{brmt}, #{brmtPlus},
			#{dc1sYn},#{dcEtc},#{dcEtcYn},#{dcGinYn},#{dcConYn},#{dcImpYn},#{dcImpEtc},#{dcImpEtcYn},
			#{evltnAYn},#{evltnBYn},#{evltnCYn},
			#{dcCon2Yn},#{dcCon4Yn},#{dcCon6Yn},#{dcCon8Yn},#{dcConEtc},#{dcConEtcYn},
			#{dcGin2Yn},#{dcGin4Yn},#{dcGin6Yn},#{dcGin8Yn},#{dcGinEtc},#{dcGinEtcYn},
			#{h2Yn},#{h4Yn},#{h6Yn},#{h8Yn},#{hEtc},#{hEtcYn},
			#{v2Yn},#{v4Yn},#{v6Yn},#{v8Yn},#{vEtc},#{vEtcYn},
			#{msrmnYear},#{msrmnMon},#{msrmnDay},#{msrmnHour},#{msrmnMin},
			#{sign},#{atchFileId},#{resultCode},
			#{indrcHYn},#{indrcHResultCode},#{indrcHMemo},
			#{indrcVYn},#{indrcVResultCode},#{indrcVMemo},
			#{cmntAYn},#{cmntEtc},#{cmntEtcYn},#{imgUrl},
			#{insMemId},#{udtMemId}
			)
			ON DUPLICATE KEY UPDATE
				VLT_AC_YN = #{vltAcYn},
			    VLT_ETC = #{vltEtc},
			    VLT_ETC_YN = #{vltEtcYn},
			    VAR_N_YN = #{varNYn},
			    VAR_Y_YN = #{varYYn},
			    ROOM1_YN = #{room1Yn},
			    ROOM2_YN = #{room2Yn},
			    ROOM_ETC_YN = #{roomEtcYn},
			    ROOM_ETC = #{roomEtc},
			    TEMP = #{temp},
			    TEMP_PLUS = #{tempPlus},
			    HMDT = #{hmdt},
			    HMDT_PLUS = #{hmdtPlus},
			    BRMT = #{brmt},
			    BRMT_PLUS = #{brmtPlus},
			    DC_1S_YN = #{dc1sYn},
			    DC_ETC = #{dcEtc},
			    DC_ETC_YN = #{dcEtcYn},
			    DC_GIN_YN = #{dcGinYn},
			    DC_CON_YN = #{dcConYn},
			    DC_IMP_YN = #{dcImpYn},
			    DC_IMP_ETC = #{dcImpEtc},
			    DC_IMP_ETC_YN = #{dcImpEtcYn},
			    EVLTN_A_YN = #{evltnAYn},
			    EVLTN_B_YN = #{evltnBYn},
			    EVLTN_C_YN = #{evltnCYn},
			    DC_CON_2_YN = #{dcCon2Yn},
			    DC_CON_4_YN = #{dcCon4Yn},
			    DC_CON_6_YN = #{dcCon6Yn},
			    DC_CON_8_YN = #{dcCon8Yn},
			    DC_CON_ETC = #{dcConEtc},
			    DC_CON_ETC_YN = #{dcConEtcYn},
			    DC_GIN_2_YN = #{dcGin2Yn},
			    DC_GIN_4_YN = #{dcGin4Yn},
			    DC_GIN_6_YN = #{dcGin6Yn},
			    DC_GIN_8_YN = #{dcGin8Yn},
			    DC_GIN_ETC = #{dcGinEtc},
			    DC_GIN_ETC_YN = #{dcGinEtcYn},
			    H_2_YN = #{h2Yn},
			    H_4_YN = #{h4Yn},
			    H_6_YN = #{h6Yn},
			    H_8_YN = #{h8Yn},
			    H_ETC = #{hEtc},
			    H_ETC_YN = #{hEtcYn},
			    V_2_YN = #{v2Yn},
			    V_4_YN = #{v4Yn},
			    V_6_YN = #{v6Yn},
			    V_8_YN = #{v8Yn},
			    V_ETC = #{vEtc},
			    V_ETC_YN = #{vEtcYn},
			    MSRMN_YEAR = #{msrmnYear},
			    MSRMN_MON = #{msrmnMon},
			    MSRMN_DAY = #{msrmnDay},
			    MSRMN_HOUR = #{msrmnHour},
			    MSRMN_MIN = #{msrmnMin},
			    SIGN = #{sign},
			    SIGN_URL = #{atchFileId},
			    RESULT_CODE = #{resultCode},
				INDRC_H_YN = #{indrcHYn},
				INDRC_H_RESULT_CODE = #{indrcHResultCode},
				INDRC_H_MEMO = #{indrcHMemo},
				INDRC_V_YN = #{indrcVYn},
				INDRC_V_RESULT_CODE  =#{indrcVResultCode},
				INDRC_V_MEMO = #{indrcVMemo},
				CMNT_A_YN = #{cmntAYn},
				CMNT_ETC = #{cmntEtc},
				CMNT_ETC_YN = #{cmntEtcYn},
				IMG_URL = #{imgUrl},
				UDT_DT = NOW(),
				UDT_MEM_ID = #{udtMemId}			
	</insert>

	<insert id="insertEsdSub">
		INSERT INTO METHOD_ESD_SUB_TB
		(
			ESD_SEQ,
			DRCTL,
			DC_CODE,
			RESULT_CODE,
			MEMO
		)
		VALUES
		<foreach collection="MethodEsdSubList" item="item" separator=",">
		(
			#{esdSeq},
			#{item.drctl},
			#{item.dcCode},
			#{item.resultCode},
			#{item.memo}
		)
		</foreach>
	</insert>
	
	<update id="updateEsdSub">
		<foreach collection="MethodEsdSubList" item="item" separator=";">
		UPDATE METHOD_ESD_SUB_TB
		SET
			DRCTL = #{item.drctl},
			DC_CODE = #{item.dcCode},
			RESULT_CODE = #{item.resultCode},
			MEMO = #{item.memo},
			STATE = #{item.state}
		WHERE ESD_SUB_SEQ = #{item.esdSubSeq}
		</foreach>
	</update>

	<update id="deleteEsdSub">
		<foreach collection="MethodEsdSubList" item="item" separator=";">
		UPDATE METHOD_ESD_SUB_TB
		SET
			STATE = #{item.state}
		WHERE ESD_SUB_SEQ = #{item.esdSubSeq}
		</foreach>
	</update>
	
	<select id="rsDetail" parameterType="int" resultType="rsDTO">
		SELECT 
			RS_SEQ,
		    RAW_SEQ,
		    VLT_AC_YN,
		    VLT_ETC,
		    VLT_ETC_YN,
		    VAR_N_YN,
		    VAR_Y_YN,
		    ROOM1_YN,
		    ROOM2_YN,
		    ROOM3_YN,
		    ROOM_ETC,
		    ROOM_ETC_YN,
		    TEMP,
		    TEMP_PLUS,
		    HMDT,
		    HMDT_PLUS,
		    BRMT,
		    BRMT_PLUS,
		    MDLT_AM_YN,
		    MDLT_ETC,
		    MDLT_ETC_YN,
		    ANTN_1M_YN,
		    ANTN_3M_YN,
		    SWEP_15_YN,
		    SWEP_1S_YN,
		    STRN_1_YN,
		    STRN_3_YN,
		    STRN_10_YN,
		    STRN_ETC,
		    STRN_ETC_YN,
		    ACRDT_FRONT_YN,
		    ACRDT_BACK_YN,
		    ACRDT_LEFT_YN,
		    ACRDT_RIGHT_YN,
		    ACRDT_ETC,
		    ACRDT_ETC_YN,
		    EVLTN_A_YN,
		    EVLTN_B_YN,
		    EVLTN_C_YN,
		    FRQNC_AREA,
		    SPC_FRQNC,
		    MSRMN_YEAR,
		    MSRMN_MON,
		    MSRMN_DAY,
		    MSRMN_HOUR,
		    MSRMN_MIN,
		    SIGN,
		    FN_GET_IMAGE(SIGN_URL,0) SIGN_URL,
		    SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    H_F_CODE,
		    H_B_CODE,
		    H_R_CODE,
		    H_L_CODE,
		    V_F_CODE,
		    V_B_CODE,
		    V_R_CODE,
		    V_L_CODE,
		    CMNT_A_YN,
		    CMNT_ETC,
		    CMNT_ETC_YN
		FROM METHOD_RS_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<select id="rsSubList" parameterType="int" resultType="egovMap">
		SELECT 
			RS_SEQ,
			RS_SUB_SEQ,
			APPL_TYPE,
			NO_YN,
			IFNULL(APPL_NAME, '') APPL_NAME,
			H_RESULT_CODE,
			V_RESULT_CODE,
			MEMO,
			STATE
		FROM METHOD_RS_SUB_TB
		WHERE 1=1
		AND STATE != 'D'
		AND RS_SEQ = #{rsSeq}
	</select>
	
	<insert id="insertRs" parameterType="rsDTO">
		<selectKey resultType="int" keyProperty="rsSeq" order="AFTER">
			SELECT RS_SEQ rsSeq FROM METHOD_RS_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
		INSERT INTO METHOD_RS_TB
		(
			RS_SEQ,
			RAW_SEQ,
			VLT_AC_YN,
			VLT_ETC,
			VLT_ETC_YN,
			VAR_N_YN,
			VAR_Y_YN,
			ROOM1_YN,
			ROOM2_YN,
			ROOM3_YN,
			ROOM_ETC,
			ROOM_ETC_YN,
			TEMP,
			TEMP_PLUS,
			HMDT,
			HMDT_PLUS,
			BRMT,
			BRMT_PLUS,
			MDLT_AM_YN,
			MDLT_ETC,
			MDLT_ETC_YN,
			ANTN_1M_YN,
			ANTN_3M_YN,
			SWEP_15_YN,
			SWEP_1S_YN,
			STRN_1_YN,
			STRN_3_YN,
			STRN_10_YN,
			STRN_ETC,
			STRN_ETC_YN,
			ACRDT_FRONT_YN,
			ACRDT_BACK_YN,
			ACRDT_LEFT_YN,
			ACRDT_RIGHT_YN,
			ACRDT_ETC,
			ACRDT_ETC_YN,
			EVLTN_A_YN,
			EVLTN_B_YN,
			EVLTN_C_YN,
			FRQNC_AREA,
			SPC_FRQNC,
			MSRMN_YEAR,
			MSRMN_MON,
			MSRMN_DAY,
			MSRMN_HOUR,
			MSRMN_MIN,
			SIGN,
			SIGN_URL,
			RESULT_CODE,
			H_F_CODE,
			H_B_CODE,
			H_R_CODE,
			H_L_CODE,
			V_F_CODE,
			V_B_CODE,
			V_R_CODE,
			V_L_CODE,
			CMNT_A_YN,
			CMNT_ETC,
			CMNT_ETC_YN,
			INS_MEM_ID,
			UDT_MEM_ID
		)
		VALUES
		(
			(SELECT ifnull(MAX(seq.RS_SEQ)+1,1) rsSeq FROM METHOD_RS_TB seq),	
			#{rawSeq},
			#{vltAcYn},
			#{vltEtc},
			#{vltEtcYn},
			#{varNYn},
			#{varYYn},
			#{room1Yn},
			#{room2Yn},
			#{room3Yn},
			#{roomEtc},
			#{roomEtcYn},
			#{temp},
			#{tempPlus},
			#{hmdt},
			#{hmdtPlus},
			#{brmt},
			#{brmtPlus},
			#{mdltAmYn},
			#{mdltEtc},
			#{mdltEtcYn},
			#{antn1mYn},
			#{antn3mYn},
			#{swep15Yn},
			#{swep1sYn},
			#{strn1Yn},
			#{strn3Yn},
			#{strn10Yn},
			#{strnEtc},
			#{strnEtcYn},
			#{acrdtFrontYn},
			#{acrdtBackYn},
			#{acrdtLeftYn},
			#{acrdtRightYn},
			#{acrdtEtc},
			#{acrdtEtcYn},
			#{evltnAYn},
			#{evltnBYn},
			#{evltnCYn},
			#{frqncArea},
			#{spcFrqnc},
			#{msrmnYear},
			#{msrmnMon},
			#{msrmnDay},
			#{msrmnHour},
			#{msrmnMin},
			#{sign},
			#{atchFileId},
			#{resultCode},
			#{hFCode},
			#{hBCode},
			#{hRCode},
			#{hLCode},
			#{vFCode},
			#{vBCode},
			#{vRCode},
			#{vLCode},
			#{cmntAYn},
			#{cmntEtc},
			#{cmntEtcYn},
			#{insMemId},
			#{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			  VLT_AC_YN = #{vltAcYn},
		      VLT_ETC = #{vltEtc},
		      VLT_ETC_YN = #{vltEtcYn},
		      VAR_N_YN = #{varNYn},
		      VAR_Y_YN = #{varYYn},
		      ROOM1_YN = #{room1Yn},
		      ROOM2_YN = #{room2Yn},
		      ROOM3_YN = #{room3Yn},
		      ROOM_ETC = #{roomEtc},
		      ROOM_ETC_YN = #{roomEtcYn},
		      TEMP = #{temp},
		      TEMP_PLUS = #{tempPlus},
		      HMDT = #{hmdt},
		      HMDT_PLUS = #{hmdtPlus},
		      BRMT = #{brmt},
		      BRMT_PLUS = #{brmtPlus},
		      MDLT_AM_YN = #{mdltAmYn},
		      MDLT_ETC = #{mdltEtc},
		      MDLT_ETC_YN = #{mdltEtcYn},
		      ANTN_1M_YN = #{antn1mYn},
		      ANTN_3M_YN = #{antn3mYn},
		      SWEP_15_YN = #{swep15Yn},
		      SWEP_1S_YN = #{swep1sYn},
		      STRN_1_YN = #{strn1Yn},
		      STRN_3_YN = #{strn3Yn},
		      STRN_10_YN = #{strn10Yn},
		      STRN_ETC = #{strnEtc},
		      STRN_ETC_YN = #{strnEtcYn},
		      ACRDT_FRONT_YN = #{acrdtFrontYn},
		      ACRDT_BACK_YN = #{acrdtBackYn},
		      ACRDT_LEFT_YN = #{acrdtLeftYn},
		      ACRDT_RIGHT_YN = #{acrdtRightYn},
		      ACRDT_ETC = #{acrdtEtc},
		      ACRDT_ETC_YN = #{acrdtEtcYn},
		      EVLTN_A_YN = #{evltnAYn},
		      EVLTN_B_YN = #{evltnBYn},
		      EVLTN_C_YN = #{evltnCYn},
		      FRQNC_AREA = #{frqncArea},
		      SPC_FRQNC = #{spcFrqnc},
		      MSRMN_YEAR = #{msrmnYear},
		      MSRMN_MON = #{msrmnMon},
		      MSRMN_DAY = #{msrmnDay},
		      MSRMN_HOUR = #{msrmnHour},
		      MSRMN_MIN = #{msrmnMin},
		      SIGN = #{sign},
		      SIGN_URL = #{atchFileId},
		      RESULT_CODE = #{resultCode},
		      H_F_CODE = #{hFCode},
		      H_B_CODE = #{hBCode},
		      H_R_CODE = #{hRCode},
		      H_L_CODE = #{hLCode},
		      V_F_CODE = #{vFCode},
		      V_B_CODE = #{vBCode},
		      V_R_CODE = #{vRCode},
		      V_L_CODE = #{vLCode},
			  CMNT_A_YN = #{cmntAYn},
			  CMNT_ETC = #{cmntEtc},
			  CMNT_ETC_YN = #{cmntEtcYn},
			  UDT_DT = NOW(),
			  UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<insert id="insertRsSub">
		INSERT INTO METHOD_RS_SUB_TB
		(
			RS_SEQ,
			APPL_TYPE,
			NO_YN,
			APPL_NAME,
			H_RESULT_CODE,
			V_RESULT_CODE,
			MEMO
		)
		VALUES
		<foreach collection="MethodRsSubList" item="item" separator=",">
		(
			#{rsSeq},
			#{item.applType},
			#{item.noYn},
			#{item.applName},
			#{item.hResultCode},
			#{item.vResultCode},
			#{item.memo}
		)
		</foreach>
	</insert>
	
	<update id="updateRsSub">
		<foreach collection="MethodRsSubList" item="item" separator=";">
		UPDATE METHOD_RS_SUB_TB
		SET
			APPL_TYPE = #{item.applType},
			NO_YN = #{item.noYn},
			APPL_NAME = #{item.applName},
			H_RESULT_CODE = #{item.hResultCode},
			V_RESULT_CODE = #{item.vResultCode},
			MEMO = #{item.memo},
			STATE = #{item.state}
		WHERE RS_SUB_SEQ = #{item.rsSubSeq}
		</foreach>
	</update>

	<update id="deleteRsSub">
		UPDATE METHOD_RS_SUB_TB
		SET
			STATE = 'D'
		WHERE RS_SEQ = #{rsSeq}
		AND STATE != 'D'
		AND APPL_TYPE = #{MethodSub.applType}
		AND NO_YN = 0
	</update>
	
	<select id="eftDetail" parameterType="int" resultType="eftDTO">
		SELECT 
			EFT_SEQ,
		    RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN,
		    VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    AC_POWER, DC_POWER, COMM_TML,
		    EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    RPTTN_5_YN, RPTTN_100_YN,
		    ACRDT_1_YN, ACRDT_2_YN, ACRDT_TRM_YN, ACRDT_TRM_ETC_YN,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN
		FROM METHOD_EFT_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<select id="eftSubList" parameterType="int" resultType="egovMap">
		SELECT 
			EFT_SUB_SEQ,
			EFT_SEQ,
			APPL_TYPE,
			NO_YN,
			POWER_L_YN,
			POWER_N_YN,
			POWER_PE_YN,
			POWER_LN_YN,
			POWER_LPE_YN,
			POWER_NPE_YN,
			POWER_LNPE_YN,
			POWER_ETC,
			POWER_ETC_YN,
			DC_POWER_P_YN,
			DC_POWER_N_YN,
			DC_POWER_PN_YN,
			DC_POWER_ETC,
			DC_POWER_ETC_YN,
			SGNL_NAME,
			PLUS_RESULT_CODE,
			MINUS_RESULT_CODE,
			MEMO,
			STATE
		FROM METHOD_EFT_SUB_TB
		WHERE 1=1
		AND STATE != 'D'
		AND EFT_SEQ = #{eftSeq}
	</select>
	
	<insert id="insertEft" parameterType="eftDTO">
		<selectKey resultType="int" keyProperty="eftSeq" order="AFTER">
	        SELECT EFT_SEQ eftSeq FROM METHOD_EFT_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
		INSERT INTO METHOD_EFT_TB
		(
			EFT_SEQ,
			RAW_SEQ,
			VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
			ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
			TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
			AC_POWER, DC_POWER, COMM_TML,
			EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
			RPTTN_5_YN, RPTTN_100_YN,
			ACRDT_1_YN, ACRDT_2_YN, ACRDT_TRM_YN, ACRDT_TRM_ETC_YN,
			MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
			SIGN, SIGN_URL,
			RESULT_CODE,
			CMNT_A_YN,
			CMNT_ETC,
			CMNT_ETC_YN,
			INS_MEM_ID,
			UDT_MEM_ID
		)
		VALUES
		(
			(SELECT ifnull(MAX(seq.EFT_SEQ)+1,1) eftSeq FROM METHOD_EFT_TB seq),
			#{rawSeq},
			#{vltAcYn},
			#{vltEtc},
			#{vltEtcYn},
			#{varNYn},
			#{varYYn},
			#{room1Yn},
			#{room2Yn},
			#{roomEtc},
			#{roomEtcYn},
			#{temp},
			#{tempPlus},
			#{hmdt},
			#{hmdtPlus},
			#{brmt},
			#{brmtPlus},
			#{acPower},
			#{dcPower},
			#{commTml},
			#{evltnAYn},
			#{evltnBYn},
			#{evltnCYn},
			#{rpttn5Yn},
			#{rpttn100Yn},
			#{acrdt1Yn},
			#{acrdt2Yn},
			#{acrdtTrmYn},
			#{acrdtTrmEtcYn},
			#{msrmnYear},
			#{msrmnMon},
			#{msrmnDay},
			#{msrmnHour},
			#{msrmnMin},
			#{sign},
			#{atchFileId},
			#{resultCode},
			#{cmntAYn},
			#{cmntEtc},
			#{cmntEtcYn},
			#{insMemId},
			#{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
		    VLT_ETC = #{vltEtc},
		    VLT_ETC_YN = #{vltEtcYn},
		    VAR_N_YN = #{varNYn},
		    VAR_Y_YN = #{varYYn},
		    ROOM1_YN = #{room1Yn},
		    ROOM2_YN = #{room2Yn},
		    ROOM_ETC = #{roomEtc},
		    ROOM_ETC_YN = #{roomEtcYn},
		    TEMP = #{temp},
		    TEMP_PLUS = #{tempPlus},
		    HMDT = #{hmdt},
		    HMDT_PLUS = #{hmdtPlus},
		    BRMT = #{brmt},
		    BRMT_PLUS = #{brmtPlus},
		    AC_POWER = #{acPower},
		    DC_POWER = #{dcPower},
		    COMM_TML = #{commTml},
		    EVLTN_A_YN = #{evltnAYn},
		    EVLTN_B_YN = #{evltnBYn},
		    EVLTN_C_YN = #{evltnCYn},
		    RPTTN_5_YN = #{rpttn5Yn},
		    RPTTN_100_YN = #{rpttn100Yn},
		    ACRDT_1_YN = #{acrdt1Yn},
		    ACRDT_2_YN = #{acrdt2Yn},
		    ACRDT_TRM_YN = #{acrdtTrmYn},
		    ACRDT_TRM_ETC_YN = #{acrdtTrmEtcYn},
		    MSRMN_YEAR = #{msrmnYear},
		    MSRMN_MON = #{msrmnMon},
		    MSRMN_DAY = #{msrmnDay},
		    MSRMN_HOUR = #{msrmnHour},
		    MSRMN_MIN = #{msrmnMin},
		    SIGN = #{sign},
		    SIGN_URL = #{atchFileId},
		    RESULT_CODE = #{resultCode},
	        CMNT_A_YN = #{cmntAYn},
	        CMNT_ETC = #{cmntEtc},
	        CMNT_ETC_YN = #{cmntEtcYn},
	        UDT_DT = NOW(),
	        UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<insert id="insertEftSub">
		INSERT INTO METHOD_EFT_SUB_TB
		(
			EFT_SEQ,
			APPL_TYPE,
			NO_YN,
			POWER_L_YN,
			POWER_N_YN,
			POWER_PE_YN,
			POWER_LN_YN,
			POWER_LPE_YN,
			POWER_NPE_YN,
			POWER_LNPE_YN,
			POWER_ETC,
			POWER_ETC_YN,
			DC_POWER_P_YN,
			DC_POWER_N_YN,
			DC_POWER_PN_YN,
			DC_POWER_ETC,
			DC_POWER_ETC_YN,
			SGNL_NAME,
			PLUS_RESULT_CODE,
			MINUS_RESULT_CODE,
			MEMO
		)
		VALUES
		<foreach collection="MethodEftSubList" item="item" separator=",">
		(
			#{eftSeq},
			#{item.applType},
			#{item.noYn},
			#{item.powerLYn},
			#{item.powerNYn},
			#{item.powerPeYn},
			#{item.powerLnYn},
			#{item.powerLpeYn},
			#{item.powerNpeYn},
			#{item.powerLnpeYn},
			#{item.powerEtc},
			#{item.powerEtcYn},
			#{item.dcPowerPYn},
			#{item.dcPowerNYn},
			#{item.dcPowerPnYn},
			#{item.dcPowerEtc},
			#{item.dcPowerEtcYn},
			#{item.sgnlName},
			#{item.plusResultCode},
			#{item.minusResultCode},
			#{item.memo}
		)
		</foreach>
	</insert>
	
	<update id="updateEftSub">
		<foreach collection="MethodEftSubList" item="item" separator=";">
		UPDATE METHOD_EFT_SUB_TB
		SET
			APPL_TYPE = #{item.applType},
			NO_YN = #{item.noYn},
			POWER_L_YN = #{item.powerLYn},
			POWER_N_YN = #{item.powerNYn},
			POWER_PE_YN = #{item.powerPeYn},
			POWER_LN_YN = #{item.powerLnYn},
			POWER_LPE_YN = #{item.powerLpeYn},
			POWER_NPE_YN = #{item.powerNpeYn},
			POWER_LNPE_YN = #{item.powerLnpeYn},
			POWER_ETC = #{item.powerEtc},
			POWER_ETC_YN = #{item.powerEtcYn},
			DC_POWER_P_YN = #{item.dcPowerPYn},
			DC_POWER_N_YN = #{item.dcPowerNYn},
			DC_POWER_PN_YN = #{item.dcPowerPnYn},
			DC_POWER_ETC = #{item.dcPowerEtc},
			DC_POWER_ETC_YN = #{item.dcPowerEtcYn},
			SGNL_NAME = #{item.sgnlName},
			PLUS_RESULT_CODE = #{item.plusResultCode},
			MINUS_RESULT_CODE = #{item.minusResultCode},
			MEMO = #{item.memo},
			STATE = #{item.state}
		WHERE EFT_SUB_SEQ = #{item.eftSubSeq}
		</foreach>
	</update>

	<update id="deleteEftSub">
		UPDATE METHOD_EFT_SUB_TB
		SET
			STATE = 'D'
		WHERE EFT_SEQ = #{eftSeq}
		AND STATE != 'D'
		AND APPL_TYPE = #{MethodSub.applType}
		AND NO_YN = 0
	</update>
	
	<select id="surgeDetail" parameterType="int" resultType="surgeDTO">
		SELECT 
			SURGE_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    POWER_LINE, POWER_PE, DC_POWER_PN,
		    COMM_TML_PE, COMM_TML_LINE,
		    OPEN_CRCT_50_YN, OPEN_CRCT_700_YN, SHRT_CRCT_20_YN, SHRT_CRCT_ETC, SHRT_CRCT_ETC_YN,
		    ACRDT_YN, PHASE_0_YN, PHASE_90_YN, PHASE_180_YN, PHASE_270_YN,
		    RPTTN_20_YN, RPTTN_60_YN,
		    EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    COUPLING_18_YN, COUPLING_10_YN, COUPLING_40_YN,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN
		FROM METHOD_SURGE_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<select id="surgeSubList" parameterType="int" resultType="egovMap">
		SELECT 
			SURGE_SUB_SEQ,
			SURGE_SEQ,
			APPL_TYPE,
			NO_YN,
			POWER_LN_YN,
			POWER_LPE_YN,
			POWER_NPE_YN,
			POWER_ETC,
			POWER_ETC_YN,
			DC_POWER_PN_YN,
			DC_POWER_ETC,
			DC_POWER_ETC_YN,
			SGNL_NAME,
			PLUS_RESULT_CODE,
			MINUS_RESULT_CODE,
			MEMO,
			STATE
		FROM METHOD_SURGE_SUB_TB
		WHERE 1=1
		AND STATE != 'D'
		AND SURGE_SEQ = #{surgeSeq}
	</select>
	
	<insert id="insertSurge" parameterType="surgeDTO">
		<selectKey resultType="int" keyProperty="surgeSeq" order="AFTER">
	        SELECT SURGE_SEQ surgeSeq FROM METHOD_SURGE_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
	    INSERT INTO METHOD_SURGE_TB
		(
			SURGE_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    POWER_LINE, POWER_PE, DC_POWER_PN,
		    COMM_TML_PE, COMM_TML_LINE,
		    OPEN_CRCT_50_YN, OPEN_CRCT_700_YN, SHRT_CRCT_20_YN, SHRT_CRCT_ETC, SHRT_CRCT_ETC_YN,
		    ACRDT_YN, PHASE_0_YN, PHASE_90_YN, PHASE_180_YN, PHASE_270_YN,
		    RPTTN_20_YN, RPTTN_60_YN,
		    EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    COUPLING_18_YN, COUPLING_10_YN, COUPLING_40_YN,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, SIGN_URL,
		    RESULT_CODE,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN,
		    INS_MEM_ID, UDT_MEM_ID
		)
		VALUES 
		(
			(SELECT ifnull(MAX(seq.SURGE_SEQ)+1,1) surgeSeq FROM METHOD_SURGE_TB seq), #{rawSeq},
			#{vltAcYn}, #{vltEtc}, #{vltEtcYn}, #{varNYn}, #{varYYn},
			#{room1Yn}, #{room2Yn}, #{roomEtc}, #{roomEtcYn},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus}, #{brmt}, #{brmtPlus},
			#{powerLine}, #{powerPe}, #{dcPowerPn},
			#{commTmlPe}, #{commTmlLine},
			#{openCrct50Yn}, #{openCrct700Yn}, #{shrtCrct20Yn}, #{shrtCrctEtc}, #{shrtCrctEtcYn},
			#{acrdtYn}, #{phase0Yn}, #{phase90Yn}, #{phase180Yn}, #{phase270Yn},
			#{rpttn20Yn}, #{rpttn60Yn},
			#{evltnAYn}, #{evltnBYn}, #{evltnCYn},
			#{coupling18Yn}, #{coupling10Yn}, #{coupling40Yn},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId},
			#{resultCode},
			#{cmntAYn}, #{cmntEtc}, #{cmntEtcYn},
			#{insMemId},#{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			VAR_N_YN = #{varNYn},
			VAR_Y_YN = #{varYYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM_ETC = #{roomEtc},
			ROOM_ETC_YN = #{roomEtcYn},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			BRMT = #{brmt},
			BRMT_PLUS = #{brmtPlus},
			POWER_LINE = #{powerLine},
			POWER_PE = #{powerPe},
			DC_POWER_PN = #{dcPowerPn},
			COMM_TML_PE = #{commTmlPe},
			COMM_TML_LINE = #{commTmlLine},
			OPEN_CRCT_50_YN = #{openCrct50Yn},
			OPEN_CRCT_700_YN = #{openCrct700Yn},
			SHRT_CRCT_20_YN = #{shrtCrct20Yn},
			SHRT_CRCT_ETC = #{shrtCrctEtc},
			SHRT_CRCT_ETC_YN = #{shrtCrctEtcYn},
			ACRDT_YN = #{acrdtYn},
			PHASE_0_YN = #{phase0Yn},
			PHASE_90_YN = #{phase90Yn},
			PHASE_180_YN = #{phase180Yn},
			PHASE_270_YN = #{phase270Yn},
			RPTTN_20_YN = #{rpttn20Yn},
			RPTTN_60_YN = #{rpttn60Yn},
			EVLTN_A_YN = #{evltnAYn},
			EVLTN_B_YN = #{evltnBYn},
			EVLTN_C_YN = #{evltnCYn},
			COUPLING_18_YN = #{coupling18Yn},
			COUPLING_10_YN = #{coupling10Yn},
			COUPLING_40_YN = #{coupling40Yn},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			CMNT_A_YN = #{cmntAYn},
			CMNT_ETC = #{cmntEtc},
			CMNT_ETC_YN = #{cmntEtcYn},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>	
	
	<insert id="insertSurgeSub">
		INSERT INTO METHOD_SURGE_SUB_TB
		(
			SURGE_SEQ,
			APPL_TYPE,
			NO_YN,
			POWER_LN_YN,
			POWER_LPE_YN,
			POWER_NPE_YN,
			POWER_ETC,
			POWER_ETC_YN,
			DC_POWER_PN_YN,
			DC_POWER_ETC,
			DC_POWER_ETC_YN,
			SGNL_NAME,
			PLUS_RESULT_CODE,
			MINUS_RESULT_CODE,
			MEMO
		)
		VALUES
		<foreach collection="MethodSurgeSubList" item="item" separator=",">
		(
			#{surgeSeq},
			#{item.applType},
			#{item.noYn},
			#{item.powerLnYn},
			#{item.powerLpeYn},
			#{item.powerNpeYn},
			#{item.powerEtc},
			#{item.powerEtcYn},
			#{item.dcPowerPnYn},
			#{item.dcPowerEtc},
			#{item.dcPowerEtcYn},
			#{item.sgnlName},
			#{item.plusResultCode},
			#{item.minusResultCode},
			#{item.memo}
		)
		</foreach>
	</insert>
	
	<update id="updateSurgeSub">
		<foreach collection="MethodSurgeSubList" item="item" separator=";">
		UPDATE METHOD_SURGE_SUB_TB
		SET
			APPL_TYPE = #{item.applType},
			NO_YN = #{item.noYn},
			POWER_LN_YN = #{item.powerLnYn},
			POWER_LPE_YN = #{item.powerLpeYn},
			POWER_NPE_YN = #{item.powerNpeYn},
			POWER_ETC = #{item.powerEtc},
			POWER_ETC_YN = #{item.powerEtcYn},
			DC_POWER_PN_YN = #{item.dcPowerPnYn},
			DC_POWER_ETC = #{item.dcPowerEtc},
			DC_POWER_ETC_YN = #{item.dcPowerEtcYn},
			SGNL_NAME = #{item.sgnlName},
			PLUS_RESULT_CODE = #{item.plusResultCode},
			MINUS_RESULT_CODE = #{item.minusResultCode},
			MEMO = #{item.memo},
			STATE = #{item.state}
		WHERE SURGE_SUB_SEQ = #{item.surgeSubSeq}
		</foreach>
	</update>

	<update id="deleteSurgeSub">
		UPDATE METHOD_SURGE_SUB_TB
		SET
			STATE = 'D'
		WHERE SURGE_SEQ = #{surgeSeq}
		AND STATE != 'D'
		AND APPL_TYPE = #{MethodSub.applType}
		AND NO_YN = 0
	</update>
	
	<select id="csDetail" parameterType="int" resultType="csDTO">
		SELECT 
			CS_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    STRN_1V_YN, STRN_3V_YN, STRN_10V_YN, STRN_ETC, STRN_ETC_YN,
		    SWEP_15_YN, SWEP_1_YN,MDLT_80_YN, MDLT_ETC, MDLT_ETC_YN,
		    EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    FRQNC_AREA, SPC_FRQNC,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN
		FROM METHOD_CS_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<select id="csSubList" parameterType="int" resultType="egovMap">
		SELECT 
			CS_SEQ,
			CS_SUB_SEQ,
			APPL_TYPE,
			NO_YN,
			IFNULL(APPL_NAME, '') APPL_NAME,
			CDN_M2_YN,
			CDN_M3_YN,
			EM_YN,
			ETC_YN,
			ETC,
			RESULT_CODE,
			MEMO,
			STATE
		FROM METHOD_CS_SUB_TB
		WHERE 1=1
		AND STATE != 'D'
		AND CS_SEQ = #{csSeq}
	</select>
	
	<insert id="insertCs" parameterType="csDTO">
		<selectKey resultType="int" keyProperty="csSeq" order="AFTER">
	        SELECT CS_SEQ csSeq FROM METHOD_CS_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
		INSERT INTO METHOD_CS_TB
		(
			CS_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    STRN_1V_YN, STRN_3V_YN, STRN_10V_YN, STRN_ETC, STRN_ETC_YN,
		    SWEP_15_YN, SWEP_1_YN,MDLT_80_YN, MDLT_ETC, MDLT_ETC_YN,
		    EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    FRQNC_AREA, SPC_FRQNC,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, SIGN_URL,
		    RESULT_CODE,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN,
		    INS_MEM_ID, UDT_MEM_ID
		)
		VALUES 
		(
			(SELECT IFNULL(MAX(seq.CS_SEQ)+1,1) csSeq FROM METHOD_CS_TB seq),
			#{rawSeq},
			#{vltAcYn}, #{vltEtc}, #{vltEtcYn}, #{varNYn}, #{varYYn},
			#{room1Yn}, #{room2Yn}, #{roomEtc}, #{roomEtcYn},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus}, #{brmt}, #{brmtPlus},
			#{strn1vYn}, #{strn3vYn}, #{strn10vYn}, #{strnEtc}, #{strnEtcYn},
			#{swep15Yn}, #{swep1Yn},#{mdlt80Yn}, #{mdltEtc}, #{mdltEtcYn},
			#{evltnAYn}, #{evltnBYn}, #{evltnCYn},
			#{frqncArea}, #{spcFrqnc},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId},
			#{resultCode},
			#{cmntAYn}, #{cmntEtc}, #{cmntEtcYn},
			#{insMemId}, #{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			VAR_N_YN = #{varNYn},
			VAR_Y_YN = #{varYYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM_ETC = #{roomEtc},
			ROOM_ETC_YN = #{roomEtcYn},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			BRMT = #{brmt},
			BRMT_PLUS = #{brmtPlus},
			STRN_1V_YN = #{strn1vYn},
			STRN_3V_YN = #{strn3vYn},
			STRN_10V_YN = #{strn10vYn},
			STRN_ETC = #{strnEtc},
			STRN_ETC_YN = #{strnEtcYn},
			SWEP_15_YN = #{swep15Yn},
			SWEP_1_YN = #{swep1Yn},
			MDLT_80_YN = #{mdlt80Yn},
			MDLT_ETC = #{mdltEtc},
			MDLT_ETC_YN = #{mdltEtcYn},
			EVLTN_A_YN = #{evltnAYn},
			EVLTN_B_YN = #{evltnBYn},
			EVLTN_C_YN = #{evltnCYn},
			FRQNC_AREA = #{frqncArea},
			SPC_FRQNC = #{spcFrqnc},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			CMNT_A_YN = #{cmntAYn},
			CMNT_ETC = #{cmntEtc},
			CMNT_ETC_YN = #{cmntEtcYn},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>	

	<insert id="insertCsSub">
		INSERT INTO METHOD_CS_SUB_TB
		(
			CS_SEQ,
			APPL_TYPE,
			NO_YN,
			APPL_NAME,
			CDN_M2_YN,
			CDN_M3_YN,
			EM_YN,
			ETC_YN,
			ETC,
			RESULT_CODE,
			MEMO
		)
		VALUES
		<foreach collection="MethodCsSubList" item="item" separator=",">
		(
			#{csSeq},
			#{item.applType},
			#{item.noYn},
			#{item.applName},
			#{item.cdnM2Yn},
			#{item.cdnM3Yn},
			#{item.emYn},
			#{item.etcYn},
			#{item.etc},
			#{item.resultCode},
			#{item.memo}
		)
		</foreach>
	</insert>
	
	<update id="updateCsSub">
		<foreach collection="MethodCsSubList" item="item" separator=";">
		UPDATE METHOD_CS_SUB_TB
		SET
			APPL_TYPE = #{item.applType},
			NO_YN = #{item.noYn},
			APPL_NAME = #{item.applName},
			CDN_M2_YN = #{item.cdnM2Yn},
			CDN_M3_YN = #{item.cdnM3Yn},
			EM_YN = #{item.emYn},
			ETC_YN = #{item.etcYn},
			ETC = #{item.etc},
			RESULT_CODE = #{item.resultCode},
			MEMO = #{item.memo},
			STATE = #{item.state}
		WHERE CS_SUB_SEQ = #{item.csSubSeq}
		</foreach>
	</update>

	<update id="deleteCsSub">
		UPDATE METHOD_CS_SUB_TB
		SET
			STATE = 'D'
		WHERE CS_SEQ = #{csSeq}
		AND STATE != 'D'
		AND APPL_TYPE = #{MethodSub.applType}
		AND NO_YN = 0
	</update>
		
	<select id="mfDetail" parameterType="int" resultType="mfDTO">
		SELECT 
			MF_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    MGNT_A_YN, MGNT_3_YN, MGNT_30_YN, FRQNC_50_YN, FRQNC_60_YN,
		    AXIS_X_YN, AXIS_Y_YN, AXIS_Z_YN, ACRDT,
			SF_300_YN, SF_ETC_YN, SF_ETC,
    		EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    X_STND, X_CODE, X_MEMO,
		    Y_STND, Y_CODE, Y_MEMO,
		    Z_STND, Z_CODE, Z_MEMO,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN,
		    INS_MEM_ID, UDT_MEM_ID
		FROM METHOD_MF_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	<insert id="insertMf" parameterType="mfDTO">
		<selectKey resultType="int" keyProperty="mfSeq" order="BEFORE">
	        SELECT IFNULL(MAX(MF_SEQ)+1,1) mfSeq FROM METHOD_MF_TB
	    </selectKey>
	    INSERT INTO METHOD_MF_TB
		(
			MF_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
		    MGNT_A_YN, MGNT_3_YN, MGNT_30_YN, FRQNC_50_YN, FRQNC_60_YN,
		    AXIS_X_YN, AXIS_Y_YN, AXIS_Z_YN, ACRDT,
		    SF_300_YN, SF_ETC_YN, SF_ETC,
    		EVLTN_A_YN, EVLTN_B_YN, EVLTN_C_YN,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, SIGN_URL,
		    RESULT_CODE,
		    X_STND, X_CODE, X_MEMO,
		    Y_STND, Y_CODE, Y_MEMO,
		    Z_STND, Z_CODE, Z_MEMO,
		    CMNT_A_YN, CMNT_ETC, CMNT_ETC_YN,
		    INS_MEM_ID, UDT_MEM_ID
		)
		VALUES 
		(
		    #{mfSeq},
	        #{rawSeq},
	        #{vltAcYn},
	        #{vltEtc},
	        #{vltEtcYn},
	        #{varNYn},
	        #{varYYn},
	        #{room1Yn},
	        #{room2Yn},
	        #{roomEtc},
	        #{roomEtcYn},
	        #{temp},
	        #{tempPlus},
	        #{hmdt},
	        #{hmdtPlus},
	        #{brmt},
	        #{brmtPlus},
	        #{mgntAYn},
	        #{mgnt3Yn},
	        #{mgnt30Yn},
	        #{frqnc50Yn},
	        #{frqnc60Yn},
	        #{axisXYn},
	        #{axisYYn},
	        #{axisZYn},
	        #{acrdt},
	        #{sf300Yn}, #{sfEtcYn}, #{sfEtc},
    		#{evltnAYn}, #{evltnBYn}, #{evltnCYn},
	        #{msrmnYear},
	        #{msrmnMon},
	        #{msrmnDay},
	        #{msrmnHour},
	        #{msrmnMin},
	        #{sign},
	        #{atchFileId},
	        #{resultCode},
	        #{xStnd},
	        #{xCode},
	        #{xMemo},
	        #{yStnd},
	        #{yCode},
	        #{yMemo},
	        #{zStnd},
	        #{zCode},
	        #{zMemo},
	        #{cmntAYn},
	        #{cmntEtc},
	        #{cmntEtcYn},
	        #{insMemId},
	        #{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			VAR_N_YN = #{varNYn},
			VAR_Y_YN = #{varYYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM_ETC = #{roomEtc},
			ROOM_ETC_YN = #{roomEtcYn},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			BRMT = #{brmt},
			BRMT_PLUS = #{brmtPlus},
			MGNT_A_YN = #{mgntAYn},
			MGNT_3_YN = #{mgnt3Yn},
			MGNT_30_YN = #{mgnt30Yn},
			FRQNC_50_YN = #{frqnc50Yn},
			FRQNC_60_YN = #{frqnc60Yn},
			AXIS_X_YN = #{axisXYn},
			AXIS_Y_YN = #{axisYYn},
			AXIS_Z_YN = #{axisZYn},
			ACRDT = #{acrdt},
			SF_300_YN = #{sf300Yn}, 
			SF_ETC_YN = #{sfEtcYn}, 
			SF_ETC = #{sfEtc},
    		EVLTN_A_YN = #{evltnAYn}, 
    		EVLTN_B_YN = #{evltnBYn}, 
    		EVLTN_C_YN = #{evltnCYn},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			X_STND = #{xStnd},
			X_CODE = #{xCode},
			X_MEMO = #{xMemo},
			Y_STND = #{yStnd},
			Y_CODE = #{yCode},
			Y_MEMO = #{yMemo},
			Z_STND = #{zStnd},
			Z_CODE = #{zCode},
			Z_MEMO = #{zMemo},
			CMNT_A_YN = #{cmntAYn},
			CMNT_ETC = #{cmntEtc},
			CMNT_ETC_YN = #{cmntEtcYn},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<select id="vdipDetail" parameterType="int" resultType="vdipDTO">
		SELECT 
			VDIP_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
			VOL1_RESULT_CODE, VOL1_CMNT_CODE, VOL1_CMNT, FN_CODE_NAME(VOL1_CMNT_CODE,'RV') VOL1_REPORT,
		    VOL2_RESULT_CODE, VOL2_CMNT_CODE, VOL2_CMNT, FN_CODE_NAME(VOL2_CMNT_CODE,'RV') VOL2_REPORT,
		    VOL3_RESULT_CODE, VOL3_CMNT_CODE, VOL3_CMNT, FN_CODE_NAME(VOL3_CMNT_CODE,'RV') VOL3_REPORT,
		    VOL4_RESULT_CODE, VOL4_CMNT_CODE, VOL4_CMNT, VOL4_TYPE,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE,
		    MEMO_YN, MEMO
		FROM METHOD_VDIP_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	<insert id="insertVdip" parameterType="vdipDTO">
		<selectKey resultType="int" keyProperty="vdipSeq" order="BEFORE">
	        SELECT ifnull(MAX(VDIP_SEQ)+1,1) vdipSeq FROM METHOD_VDIP_TB
	    </selectKey>
	    INSERT INTO METHOD_VDIP_TB
		(
			VDIP_SEQ, RAW_SEQ,
		    VLT_AC_YN, VLT_ETC, VLT_ETC_YN, VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS, BRMT, BRMT_PLUS,
			VOL1_RESULT_CODE, VOL1_CMNT_CODE, VOL1_CMNT,
		    VOL2_RESULT_CODE, VOL2_CMNT_CODE, VOL2_CMNT,
		    VOL3_RESULT_CODE, VOL3_CMNT_CODE, VOL3_CMNT,
		    VOL4_RESULT_CODE, VOL4_CMNT_CODE, VOL4_CMNT, VOL4_TYPE,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, SIGN_URL,
		    RESULT_CODE,
		    MEMO_YN, MEMO,
		    INS_MEM_ID, UDT_MEM_ID
		)
	 	VALUES 
	    (
	        #{vdipSeq}, #{rawSeq},
	        #{vltAcYn}, #{vltEtc}, #{vltEtcYn}, #{varNYn}, #{varYYn},
	        #{room1Yn}, #{room2Yn}, #{roomEtc}, #{roomEtcYn},
	        #{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus}, #{brmt}, #{brmtPlus},
			#{vol1ResultCode}, #{vol1CmntCode}, #{vol1Cmnt},
			#{vol2ResultCode}, #{vol2CmntCode}, #{vol2Cmnt},
			#{vol3ResultCode}, #{vol3CmntCode}, #{vol3Cmnt},
			#{vol4ResultCode}, #{vol4CmntCode}, #{vol4Cmnt}, #{vol4Type},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId},
			#{resultCode},
			#{memoYn},#{memo}, 
			#{insMemId},#{udtMemId}
	    )
	    ON DUPLICATE KEY UPDATE
	        VLT_AC_YN = #{vltAcYn},
	        VLT_ETC = #{vltEtc},
	        VLT_ETC_YN = #{vltEtcYn},
	        VAR_N_YN = #{varNYn},
	        VAR_Y_YN = #{varYYn},
	        ROOM1_YN = #{room1Yn},
	        ROOM2_YN = #{room2Yn},
	        ROOM_ETC = #{roomEtc},
	        ROOM_ETC_YN = #{roomEtcYn},
	        TEMP = #{temp},
	        TEMP_PLUS = #{tempPlus},
	        HMDT = #{hmdt},
	        HMDT_PLUS = #{hmdtPlus},
	        BRMT = #{brmt},
	        BRMT_PLUS = #{brmtPlus},
	        VOL1_RESULT_CODE = #{vol1ResultCode}, 
	        VOL1_CMNT_CODE = #{vol1CmntCode}, 
	        VOL1_CMNT = #{vol1Cmnt},
		    VOL2_RESULT_CODE = #{vol2ResultCode}, 
		    VOL2_CMNT_CODE = #{vol2CmntCode}, 
		    VOL2_CMNT = #{vol2Cmnt},
		    VOL3_RESULT_CODE = #{vol3ResultCode},
		    VOL3_CMNT_CODE = #{vol3CmntCode}, 
		    VOL3_CMNT = #{vol3Cmnt},
		    VOL4_RESULT_CODE = #{vol4ResultCode},
		    VOL4_CMNT_CODE = #{vol4CmntCode}, 
		    VOL4_CMNT = #{vol4Cmnt},
		    VOL4_TYPE = #{vol4Type},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			MEMO_YN = #{memoYn}, 
			MEMO = #{memo},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>

	<select id="ctiDetail" parameterType="int" resultType="ctiDTO">
		SELECT 
			CTI_SEQ, RAW_SEQ,
		    VLT_DC12_YN, VLT_DC24_YN,
		    VAR_N_YN, VAR_Y_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
		    TEMP, TEMP_PLUS,
		    HMDT, HMDT_PLUS,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE
		FROM METHOD_CTI_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	<insert id="insertCti" parameterType="ctiDTO">
		<selectKey resultType="int" keyProperty="ctiSeq" order="AFTER">
	        SELECT CTI_SEQ FROM METHOD_CTI_TB WHERE RAW_SEQ = #{rawSeq}
	    </selectKey>
	    INSERT INTO METHOD_CTI_TB (
	        CTI_SEQ, RAW_SEQ,
	        VLT_DC12_YN, VLT_DC24_YN,
	        VAR_N_YN, VAR_Y_YN,
	        ROOM1_YN, ROOM2_YN, ROOM_ETC, ROOM_ETC_YN,
	        TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
	        MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
	        SIGN, SIGN_URL,
	        RESULT_CODE
	    ) 
	    VALUES (
	       (SELECT ifnull(MAX(seq.CTI_SEQ)+1,1) ctiSeq FROM METHOD_CTI_TB seq), #{rawSeq},
	        #{vltDc12Yn}, #{vltDc24Yn},
	        #{varNYn}, #{varYYn},
	        #{room1Yn}, #{room2Yn}, #{roomEtc}, #{roomEtcYn},
	        #{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus},
	        #{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
	        #{sign}, #{signUrl},
	        #{resultCode}
	    )
	    ON DUPLICATE KEY UPDATE
	        VLT_DC12_YN = #{vltDc12Yn},
	        VLT_DC24_YN = #{vltDc24Yn},
	        VAR_N_YN = #{varNYn},
	        VAR_Y_YN = #{varYYn},
	        ROOM1_YN = #{room1Yn},
	        ROOM2_YN = #{room2Yn},
	        ROOM_ETC = #{roomEtc},
	        ROOM_ETC_YN = #{roomEtcYn},
	        TEMP = #{temp},
	        TEMP_PLUS = #{tempPlus},
	        HMDT = #{hmdt},
	        HMDT_PLUS = #{hmdtPlus},
	        MSRMN_YEAR = #{msrmnYear},
	        MSRMN_MON = #{msrmnMon},
	        MSRMN_DAY = #{msrmnDay},
	        MSRMN_HOUR = #{msrmnHour},
	        MSRMN_MIN = #{msrmnMin},
	        SIGN = #{sign},
	        <if test="signUrl != null and signUrl != ''">SIGN_URL = #{signUrl},</if>
	        RESULT_CODE = #{resultCode}
	</insert>

	<insert id="insertCtiSub">
		<foreach collection="ctiSubList" item="item" separator=";">
		INSERT INTO METHOD_CTI_SUB_TB
		(
			CTI_SUB_SEQ,
			CTI_SEQ,
			DC_TYPE,
			PULSE,
			STANDARD,
			RESULT_CODE,
			TEST_MEMO
		)
		VALUES
		(
			#{item.ctiSubSeq},
			#{ctiSeq},
			#{item.dcType},
			#{item.pulse},
			#{item.standard},
			#{item.resultCode},
			#{item.testMemo}
		)
		ON DUPLICATE KEY UPDATE
			DC_TYPE = #{item.dcType},
			PULSE = #{item.pulse},
			STANDARD = #{item.standard},
			RESULT_CODE = #{item.resultCode},
			TEST_MEMO = #{item.testMemo}
		</foreach>
	</insert>
	
	<select id="ctiSubList" parameterType="int" resultType="egovMap">
		SELECT 
			CTI_SUB_SEQ,
		    CTI_SEQ,
		    DC_TYPE,
		    PULSE,
		    STANDARD,
		    RESULT_CODE,
		    TEST_MEMO
		FROM METHOD_CTI_SUB_TB
		WHERE 1=1
		AND CTI_SEQ = #{ctiSeq}
	</select>
	
	<insert id="insertClk" parameterType="clkDTO">
		<selectKey resultType="int" keyProperty="ckSeq" order="BEFORE">
	        SELECT IFNULL(MAX(CK_SEQ)+1,1) ckSeq FROM METHOD_CK_TB
	    </selectKey>
		INSERT INTO METHOD_CK_TB
		(
			CK_SEQ, RAW_SEQ, VLT_AC_YN, VLT_ETC, VLT_ETC_YN,
			ROOM1_YN, ROOM2_YN, ROOM3_YN, ROOM_ETC_YN, ROOM_ETC,
			TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
			MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
			SIGN, SIGN_URL, RESULT_CODE, INS_MEM_ID, UDT_MEM_ID
		)
		VALUES
		(
			#{ckSeq}, #{rawSeq}, #{vltAcYn}, #{vltEtc}, #{vltEtcYn},
			#{room1Yn}, #{room2Yn}, #{room3Yn}, #{roomEtcYn}, #{roomEtc},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId}, #{resultCode}, #{insMemId}, #{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM3_YN = #{room3Yn},
			ROOM_ETC_YN = #{roomEtcYn},
			ROOM_ETC = #{roomEtc},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<select id="clkDetail" parameterType="int" resultType="clkDTO">
		SELECT CK_SEQ, RAW_SEQ, VLT_AC_YN, VLT_ETC, VLT_ETC_YN,
		    ROOM1_YN, ROOM2_YN, ROOM3_YN, ROOM_ETC_YN, ROOM_ETC,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID, RESULT_CODE
		FROM METHOD_CK_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
	
	<insert id="insertDp" parameterType="dpDTO">
		<selectKey resultType="int" keyProperty="dpSeq" order="BEFORE">
	        SELECT IFNULL(MAX(DP_SEQ)+1,1) dpSeq FROM METHOD_DP_TB
	    </selectKey>
		INSERT INTO METHOD_DP_TB
		(
			DP_SEQ, RAW_SEQ, VLT_AC_YN, VLT_ETC, VLT_ETC_YN,
			ROOM1_YN, ROOM2_YN, ROOM_ETC_YN, ROOM_ETC,
			TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
			MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
			SIGN, SIGN_URL, RESULT_CODE, INS_MEM_ID, UDT_MEM_ID
		)
		VALUES
		(
			#{dpSeq}, #{rawSeq}, #{vltAcYn}, #{vltEtc}, #{vltEtcYn},
			#{room1Yn}, #{room2Yn}, #{roomEtcYn}, #{roomEtc},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId}, #{resultCode}, #{insMemId}, #{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			VLT_AC_YN = #{vltAcYn},
			VLT_ETC = #{vltEtc},
			VLT_ETC_YN = #{vltEtcYn},
			ROOM1_YN = #{room1Yn},
			ROOM2_YN = #{room2Yn},
			ROOM_ETC_YN = #{roomEtcYn},
			ROOM_ETC = #{roomEtc},
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<select id="dpDetail" parameterType="int" resultType="dpDTO">
		SELECT DP_SEQ, RAW_SEQ, VLT_AC_YN, VLT_ETC, VLT_ETC_YN,
		    ROOM1_YN, ROOM2_YN, ROOM_ETC_YN, ROOM_ETC,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID, RESULT_CODE
		FROM METHOD_DP_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>

	<insert id="insertTel" parameterType="telDTO">
		<selectKey resultType="int" keyProperty="telSeq" order="BEFORE">
	        SELECT IFNULL(MAX(TEL_SEQ)+1,1) telSeq FROM METHOD_TEL_TB
	    </selectKey>
		INSERT INTO METHOD_TEL_TB
		(
			TEL_SEQ, RAW_SEQ,
			TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
			MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
			SIGN, SIGN_URL, 
			RESULT_CODE, RESULT_PASS_CODE, RESULT_RESET_CODE, RESULT_NO_PASS_CODE, RESULT_NEW_PASS_CODE,
			CMNT_A_YN, CMNT_B_YN, CMNT_ETC, CMNT_ETC_YN,
			INS_MEM_ID, UDT_MEM_ID
		)
		VALUES
		(
			#{telSeq}, #{rawSeq},
			#{temp}, #{tempPlus}, #{hmdt}, #{hmdtPlus},
			#{msrmnYear}, #{msrmnMon}, #{msrmnDay}, #{msrmnHour}, #{msrmnMin},
			#{sign}, #{atchFileId}, 
			#{resultCode}, #{resultPassCode}, #{resultResetCode}, #{resultNoPassCode}, #{resultNewPassCode},
			#{cmntAYn}, #{cmntBYn}, #{cmntEtc},#{cmntEtcYn},
			#{insMemId}, #{udtMemId}
		)
		ON DUPLICATE KEY UPDATE
			TEMP = #{temp},
			TEMP_PLUS = #{tempPlus},
			HMDT = #{hmdt},
			HMDT_PLUS = #{hmdtPlus},
			MSRMN_YEAR = #{msrmnYear},
			MSRMN_MON = #{msrmnMon},
			MSRMN_DAY = #{msrmnDay},
			MSRMN_HOUR = #{msrmnHour},
			MSRMN_MIN = #{msrmnMin},
			SIGN = #{sign},
			SIGN_URL = #{atchFileId},
			RESULT_CODE = #{resultCode},
			RESULT_PASS_CODE = #{resultPassCode}, 
			RESULT_RESET_CODE = #{resultResetCode}, 
			RESULT_NO_PASS_CODE = #{resultNoPassCode}, 
			RESULT_NEW_PASS_CODE = #{resultNewPassCode},
			CMNT_A_YN = #{cmntAYn},
			CMNT_B_YN = #{cmntBYn}, 
			CMNT_ETC = #{cmntEtc}, 
			CMNT_ETC_YN = #{cmntEtcYn},
			UDT_DT = NOW(),
			UDT_MEM_ID = #{udtMemId}
	</insert>
	
	<select id="telDetail" parameterType="int" resultType="telDTO">
		SELECT TEL_SEQ, RAW_SEQ,
		    TEMP, TEMP_PLUS, HMDT, HMDT_PLUS,
		    MSRMN_YEAR, MSRMN_MON, MSRMN_DAY, MSRMN_HOUR, MSRMN_MIN,
		    SIGN, FN_GET_IMAGE(SIGN_URL,0) SIGN_URL, SIGN_URL ATCH_FILE_ID,
		    RESULT_CODE, RESULT_PASS_CODE, RESULT_RESET_CODE, RESULT_NO_PASS_CODE, RESULT_NEW_PASS_CODE,
			CMNT_A_YN, CMNT_B_YN, CMNT_ETC, CMNT_ETC_YN
		FROM METHOD_TEL_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
	</select>
		
	<insert id="insertImg" parameterType="imgDTO">
		<selectKey resultType="int" keyProperty="imgSeq" order="BEFORE">
	        SELECT ifnull(MAX(IMG_SEQ)+1,1) FROM METHOD_IMG_TB
	    </selectKey>
	    INSERT INTO METHOD_IMG_TB
	    (
	    	IMG_SEQ,
	    	RAW_SEQ,
	    	PIC_ID,
	    	PIC_YN,
	    	ATCH_FILE_ID,
	    	INS_MEM_ID,
	    	UDT_MEM_ID
	    )
	    VALUES
	    (
	    	#{imgSeq},
	    	#{rawSeq},
	    	#{picId},
	    	#{picYn},
	    	#{atchFileId},
	    	#{insMemId},
	    	#{udtMemId}
	    )
	    ON DUPLICATE KEY UPDATE
	    	PIC_YN = #{picYn},
	    	UDT_MEM_ID = #{udtMemId},
	    	UDT_DT = NOW()
	</insert>
	
	<select id="imgDetail" parameterType="imgDTO" resultType="imgDTO">
		SELECT RAW_SEQ, PIC_ID, ATCH_FILE_ID, PIC_YN
		FROM METHOD_IMG_TB
		WHERE 1=1
		AND RAW_SEQ = #{rawSeq}
		AND PIC_ID = #{picId}
	</select>

	<select id="imgList" parameterType="int" resultType="imgDTO">
        SELECT 
			IFNULL(METHOD_IMG_TB.RAW_SEQ, #{rawSeq}), cast(num as unsigned) pic_id, IFNULL(IF(num = 14, 1, RAW_MET_TB.CHECK_YN), 0) check_yn, IFNULL(PIC_YN, 0) pic_yn, 
			(SELECT COUNT(1) FROM FILE_DETAIL_TB WHERE ATCH_FILE_ID = METHOD_IMG_TB.ATCH_FILE_ID AND STATE != 'D') regCnt
        FROM (
			SELECT @num := @num + 1 AS num
			FROM INFORMATION_SCHEMA.TABLES, (SELECT @num := 0) temp
			LIMIT 0, 19
        ) numb
			
			LEFT JOIN METHOD_IMG_TB
            ON numb.num = PIC_ID
            AND METHOD_IMG_TB.RAW_SEQ = #{rawSeq}
            
            LEFT JOIN RAW_MET_TB
            ON CASE WHEN numb.num=15 THEN 1
					WHEN numb.num=16 THEN 14
                    WHEN numb.num=17 THEN 15
                    WHEN numb.num=18 THEN 16
				ELSE numb.num END = RAW_MET_TB.MET_SEQ+1
            AND RAW_MET_TB.RAW_SEQ =#{rawSeq}
            ;
	</select>
		
</mapper>